# 3. –û—Å–Ω–æ–≤—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å pytest
# –§–∞–π–ª test_prime_pt.py —Å –∫–µ–π—Å–∞–º–∏ pytest
import pytest
from prime_pytest import is_prime


def test_is_prime():
    assert not is_prime(42), '42 - —Å–æ—Å—Ç–∞–≤–Ω–æ–µ —á–∏—Å–ª–æ'
    assert is_prime(73), '73 - –ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ'


def test_type():
    with pytest.raises(TypeError):
        is_prime(3.14)


def test_value():
    with pytest.raises(ValueError):
        is_prime(-100)


def test_value_with_text():
    with pytest.raises(ValueError, match=r'The number P must be greater than 1'):
        is_prime(1)


def test_warning_false(capfd):
    is_prime(100_000_001)
    captured = capfd.readouterr()
    assert captured.out == 'If the number P is prime, the check may take a long time. Working...\n'


def test_warning_true(capfd):
    is_prime(100_000_007)
    captured = capfd.readouterr()
    assert captured.out == 'If the number P is prime, the check may take a long time. Working...\n'


if __name__ == '__main__':
    pytest.main(['-v'])
# –ù–∞—á–∞–ª–æ —Å –∏–º–ø–æ—Ä—Ç–æ–º –∏ –∫–æ–Ω–µ—Ü —Å –∑–∞–ø—É—Å–∫–æ–º —Ç–µ—Å—Ç–æ–≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–ª—è Python. –†–∞–∑–±–µ—Ä—ë–º
# –∫–∞–∂–¥—ã–π –∏–∑ –∫–µ–π—Å–æ–≤.
# ‚û¢ –ö–µ–π—Å test_is_prime
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—É—é —Ä–∞–±–æ—Ç—É —Ñ—É–Ω–∫—Ü–∏–∏. –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ assert not –æ–∂–∏–¥–∞–µ—Ç –ø–æ–ª—É—á–∏—Ç—å
# –ª–æ–∂—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏. –í—Ç–æ—Ä–æ–π assert –æ–∂–∏–¥–∞–µ—Ç –ø–æ–ª—É—á–∏—Ç—å
# –∏—Å—Ç–∏–Ω—É.
# üî• –í–∞–∂–Ω–æ! –ï—Å–ª–∏ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –ø—Ä–æ–≤–∞–ª–∏—Ç —Ç–µ—Å—Ç, –≤—Ç–æ—Ä–æ–π assert –Ω–µ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω
# –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏. –û–±—ã—á–Ω–æ –≤–Ω—É—Ç—Ä–∏ –∫–µ–π—Å–∞ –ø–∏—à—É—Ç –æ–¥–Ω–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ
# –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–µ–π—Å–∞.
# ‚û¢ –ö–µ–π—Å test_type
# –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ pytest.raises –∫–æ—Ç–æ—Ä—ã–π –æ–∂–∏–¥–∞–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –æ—à–∏–±–∫—É
# TypeError –ø—Ä–∏ –≤—ã–∑–æ–≤–µ is_prime —Å –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —á–∏—Å–ª–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞.
# –ù–∞–ª–∏—á–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç, –∞ –µ—ë –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ - —Ä–æ–Ω—è–µ—Ç. –°—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞
# –ø–æ–¥–Ω—è—Ç—å –æ—à–∏–±–∫—É - –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –≤–Ω—É—Ç—Ä–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –î–∞–ª—å–Ω–µ–π—à–∏–π –∫–æ–¥
# –Ω–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è.
# 25
# ‚û¢ –ö–µ–π—Å test_value
# –¢–µ—Å—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞, –Ω–æ –º—ã —É–∫–∞–∑–∞–ª–∏ –¥—Ä—É–≥—É—é –æ—à–∏–±–∫—É –≤
# –º–µ–Ω–µ–¥–∂–µ—Ä–µ –∏ –ø–µ—Ä–µ–¥–∞–ª–∏ –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Ñ—É–Ω–∫—Ü–∏—é.
# ‚û¢ –ö–µ–π—Å test_value_with_text
# –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é. –ü–æ–º–∏–º–æ –æ—à–∏–±–∫–∏ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä match
# –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ. –ï—Å–ª–∏ –æ–Ω–æ —Å–æ–≤–ø–∞–¥—ë—Ç —Å —Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏, —Ç–µ—Å—Ç –±—É–¥–µ—Ç
# –ø—Ä–æ–π–¥–µ–Ω.
# ‚û¢ –ö–µ–π—Å—ã test_warning_false –∏ test_warning_true
# –í–Ω–∏–º–∞–Ω–∏–µ! –û–±–∞ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—Ö–æ–¥—è—Ç –∑–∞ —Ä–∞–º–∫–∏ –æ—Å–Ω–æ–≤ pytest. –≠—Ç–æ —Å–∫–æ—Ä–µ–µ –ø—Ä–∏–º–µ—Ä –Ω–∞
# –±—É–¥—É—â–µ–µ –¥–ª—è —Å–∞–º—ã—Ö –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã—Ö.
# –ö–µ–π—Å –ø–æ–ª—É—á–∞–µ—Ç —Ñ–∏–∫—Å—Ç—É—Ä—É capfd –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞. capfd (capture file descriptors)
# —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –≤ pytest —Ñ–∏–∫—Å—Ç—É—Ä, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å
# –ø–æ—Ç–æ–∫–∏ –≤—ã–≤–æ–¥–∞ –∏ –æ—à–∏–±–æ–∫. –í–Ω—É—Ç—Ä–∏ –∫–µ–π—Å–∞ –≤—ã–∑—ã–≤–∞–µ–º —Ç–µ—Å—Ç–∏—Ä—É–µ–º—É—é —Ñ—É–Ω–∫—Ü–∏—é. –î–∞–ª–µ–µ
# –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ readouterr() –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é captured. –í
# —Ñ–∏–Ω–∞–ª–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç captured.out (–ø–æ—Ç–æ–∫–∞ –≤—ã–≤–æ–¥–∞) —Å –æ–∂–∏–¥–∞–µ–º—ã–º —Ç–µ–∫—Å—Ç–æ–º
# —Å–æ–æ–±—â–µ–Ω–∏—è.
